"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[611],{68611:(e,t,i)=>{i.r(t),i.d(t,{default:()=>E});var s=i(98135),n=i.n(s),o=i(59713),r=i.n(o),a=(i(33948),i(67294)),l=i.n(a),d=i(66832),h=i(19748),u=i(82990),c=i(28121),p=i(8848),m=i(28240),f=i(36360),g=i(95477),y=i(33846),v=i(12042),S=i(62727),w=i(45023),R=i(47966),b=i(96486),C=i.n(b),k=i(3779),Z=i(28020),I=i(39249),x=(i(27369),i(26111)),V=i(77671);class B extends d.Z{constructor(...e){super(...e),r()(this,"searchRef",l().createRef()),r()(this,"firstApiRef",l().createRef()),r()(this,"apiSectionRefs",{find:l().createRef(),pricing:l().createRef(),recovery:l().createRef(),security:l().createRef(),rateLimits:l().createRef(),experiments:l().createRef(),findAdminLogs:l().createRef(),utilities:l().createRef()}),r()(this,"storeTypes",{searchStore:y.Z}),r()(this,"scrollToSection",(e=>{const t=this.apiSectionRefs[e];t.current&&t.current.scrollIntoView()})),r()(this,"handleKeyDown",(e=>{(0,w.Z)(this.environment,e,"command+/")&&(e.preventDefault(),this.stores.searchStore.reset(),this.searchRef.current&&this.searchRef.current.focusInput())})),r()(this,"handleLogOut",(()=>{V.B(this.environment)}))}didMount(){window.addEventListener("keydown",this.handleKeyDown)}willUnmount(){window.removeEventListener("keydown",this.handleKeyDown)}renderComponent(){const e=(0,Z.S4)(this.environment),{searchStore:t}=this.stores,i=t.state.inputValue.toLowerCase(),s=(0,v.v2)(),o=s?v.Fr:v.Fr.filter((e=>"full"!==e.requiresRole)),r=i.length>1?o.filter((e=>(0,v.H2)(e,new RegExp(i,"i")))):o;let a=!0;const d=v.KC.map((e=>{const t=r.filter((t=>t.sectionName===e)).map((e=>{const t=a?this.firstApiRef:void 0;return a=!1,l().createElement(h.Z,{style:B.itemStyle,ref:t,key:e.apiName,api:e})}));return this.renderSection({key:e,title:v._c[e].title,children:t})}));return n()(f.Z,{title:"Notion Admin Mode"},void 0,n()("div",{style:B.wrapStyle},void 0,n()("div",{style:B.style},void 0,n()("div",{style:B.itemStyle},void 0,n()("div",{style:B.headerStyle},void 0,"Notion ",!s&&"Restricted"," Admin Mode"," ","production"!==g.default.env?"(".concat(g.default.env,")"):void 0),n()("div",{style:{marginBottom:12}},void 0,n()(m.Z,{href:"https://dev.notion.so/notion/Use-Admin-Mode-05f1e0ad9aa749a4b3dc07410b499465",external:!0,inline:!0,underline:!0},void 0,"Click here")," ","to learn more about how to use Admin Mode."),n()("div",{style:{display:"flex"}},void 0,n()("div",{style:{flex:1}},void 0,"Currently Logged in as:"," ",e&&e.email),n()(R.Z,{onClick:this.handleLogOut,style:{height:"auto"}},void 0,"Log Out")),s&&n()(c.Z,{}),!s&&n()(R.Z,{onClick:()=>{(0,x.navigate)({environment:this.environment,url:"/"})},style:{marginTop:12,display:"flex",alignItems:"center"}},void 0,k.Z.arrowLeft({width:12,height:12,marginRight:12}),"Navigate to user workspace")),n()("div",{style:B.itemStyle},void 0,n()("div",{style:{fontWeight:u.Z.fontWeight.bold,fontSize:18,marginBottom:6}},void 0,"Go to (cmd-/)"),n()("div",{style:{marginBottom:14,display:"flex"}},void 0,l().createElement(S.Z,{showClearButton:!0,placeholder:"Filter, then press enter to jump",ref:this.searchRef,focusInitial:!0,value:this.stores.searchStore.state.inputValue,onChange:e=>{t.setState({...t.state,inputValue:e.target.value})},left:k.Z.searchThick({width:14,height:14,marginRight:6,flexGrow:0,flexShrink:0,fill:p.Vx().mediumIconColor}),onSubmit:()=>{this.firstApiRef.current&&this.firstApiRef.current.focus()}})),v.KC.map((e=>n()("div",{style:{marginTop:6}},e,n()(m.Z,{onClick:()=>this.scrollToSection(e),underline:!0},void 0,v._c[e].title))))),d,r.length<o.length&&n()("div",{style:{opacity:.7,width:"100%",color:p.Vx().lightIconColor,margin:8,fontStyle:"italic"}},void 0,o.length-r.length,' hidden. To show all, press Cmd-/ or click "Clear" above.',n()("br",{}),this.randomQuip())),n()(I.Ix,{hideProgressBar:!0,autoClose:1500,transition:I.Mi})))}renderSection(e){const{title:t,children:i,key:s}=e;if(i&&(!Array.isArray(i)||i.length))return l().createElement("div",{ref:this.apiSectionRefs[s],id:s,key:s,style:{...B.style,marginTop:12,marginBottom:12,width:"100%"}},n()("div",{style:{...B.headerStyle,width:"100%",marginLeft:B.itemStyle.margin}},void 0,t),i)}randomQuip(){return C().sample(["Hi, spam duplicate","Your hair is looking so nice today!",'"The faster we are at getting botter, the faster we get botter" - Doug EngelBot',"You're doing a great job, keep it up!!","Computing for everyone","Remember to take a stretch break every once in a while"])}}r()(B,"wrapStyle",{height:"100vh",overflow:"auto",background:p.Vx().sidebarBackground,padding:8}),r()(B,"style",{display:"flex",flexWrap:"wrap"}),r()(B,"headerStyle",{fontWeight:u.Z.fontWeight.bold,fontSize:36}),r()(B,"itemStyle",{width:500,padding:18,margin:8,border:"1px solid ".concat(p.Vx().outlineButtonBorder),background:"white",position:"relative"});const E=B},19748:(e,t,i)=>{i.d(t,{Z:()=>N});var s=i(98135),n=i.n(s),o=i(67154),r=i.n(o),a=i(59713),l=i.n(a),d=(i(33948),i(41817),i(85827),i(67294)),h=i.n(d),u=i(96486),c=i.n(u),p=i(61269),m=i(52016);class f extends m.Z{getInitialState(){return{inputValues:{}}}}const g=f;var y=i(66832),v=i(62727),S=i(4615),w=i(79583),R=i(48762),b=i(92625),C=i(82990),k=i(82970),Z=i(47966),I=i(15102),x=i(6958),V=i(12042),B=i(46951),E=i(5366),A=i(8848),M=i(3104),L=i(68932),T=i(12318);class K extends y.Z{constructor(...e){super(...e),l()(this,"firstInputRef",h().createRef()),l()(this,"fileInputRef",h().createRef()),l()(this,"storeTypes",{store:g,fileNameStore:T.Z.of("")}),l()(this,"renderKey",((e,t,i)=>{const{store:s}=this.stores,o=s.state.inputValues[t],a=0===i?this.firstInputRef:void 0;let l;if(e.type===V.It.String)l=h().createElement(v.Z,{ref:a,value:"string"==typeof o?o:"",showClearButton:!0,onChange:e=>{s.setState({response:void 0,inputValues:{...s.state.inputValues,[t]:e.target.value}})},onSubmit:this.handleSubmit,onClearButtonClick:()=>{s.setState({response:void 0,inputValues:{...s.state.inputValues,[t]:void 0}})}});else if(e.type===V.It.Number)l=h().createElement(v.Z,{ref:a,type:"number",value:"number"==typeof o?o.toString():"",onChange:e=>{s.setState({response:void 0,inputValues:{...s.state.inputValues,[t]:parseInt(e.target.value)}})},onSubmit:this.handleSubmit});else if(e.type===V.It.Options){const i=[K.undefinedKey,...e.options],n={menuTitle:t,items:i,selectedItem:o,onSelect:e=>{s.setState({response:void 0,inputValues:{...s.state.inputValues,[t]:e===K.undefinedKey?void 0:e}})},getKey:e=>e,renderItem:e=>h().createElement(R.Z,r()({},e,{title:e.value===K.undefinedKey?"Empty":e.value})),renderOrigin:e=>h().createElement(Z.Z,r()({isLarge:!0,style:{marginBottom:8}},e),o||"Empty"),width:300};l=h().createElement(w.Z,n)}else e.type===V.It.Boolean?l=n()(k.Z,{checked:Boolean(o),size:20,onClick:e=>{s.setState({response:void 0,inputValues:{...s.state.inputValues,[t]:!Boolean(o)}})}}):e.type===V.It.Csv&&(l=h().createElement(h().Fragment,null,n()(Z.Z,{isLarge:!0,onClick:()=>{var e,t;null===(e=this.fileInputRef)||void 0===e||null===(t=e.current)||void 0===t||t.click()},style:{marginRight:10}},void 0,"Upload"),this.stores.fileNameStore.state,h().createElement("input",{ref:this.fileInputRef,style:{display:"none"},type:"file",name:e.name||"csv file",onChange:e=>this.handleOnChangeCsvFile(t,e)})));return n()("div",{},t,n()("div",{style:{marginTop:12,marginBottom:4}},void 0,c().startCase(t)),e.comment&&n()(B.Z,{isSmall:!0,isMultiline:!0,style:{marginTop:4,marginBottom:8}},void 0,e.comment),l)})),l()(this,"handleOnChangeCsvFile",(async(e,t)=>{const{store:i,fileNameStore:s}=this.stores,n=t.target.files;if(null==n||!n.length)return;const o=n[0],r=await o.text();s.set(o.name),i.setState({response:void 0,inputValues:{...i.state.inputValues,[e]:r}})})),l()(this,"handleSubmit",(()=>{const{store:e}=this.stores,{apiName:t,schema:i}=this.props.api,{inputValues:s}=e.state,n=(0,E.defineMessages)({loading:{id:"adminAPIRequest.loadingMessage",defaultMessage:"Loadingâ€¦"}}),o={};for(const a of Object.keys(s)){const e=s[a];i[a]&&(c().isString(e)&&S.qn(e)?o[a]=S.wr(e):o[a]=e)}b.j({message:n.loading});const r=p[t];if(!r)throw new Error("Missing api handler for ".concat(t," - likely either a typo in client/helpers/adminHelpers.tsx or missing declaration in client/actions/api.ts"));r(this.environment,o).then((i=>{b.x(),p.csvApiTriggers[t]&&this.downloadAsCsv(i)||e.setState({...e.state,response:i})}))})),l()(this,"handleModalDismiss",(()=>{const{store:e}=this.stores;e.state.response&&("failed"===e.state.response.type?e.setState({inputValues:e.state.inputValues}):this.resetStoreState(this.props))}))}willMount(e){this.resetStoreState(e)}didMount(){this.shouldShowInline()&&this.handleSubmit()}renderComponent(){const{api:e,defaultParams:t,style:i}=this.props,{apiName:s,displayName:o,schema:r,description:a,emoji:l,isDestructive:d,requiresRole:u}=e,{response:p}=this.stores.store.state;return n()("div",{style:i},void 0,n()("div",{style:K.headerStyle},void 0,n()(x.Z,{size:24,emoji:l}),n()("span",{style:{marginLeft:4}},void 0,o||c().startCase(s))),a&&n()(B.Z,{isSmall:!0,isMultiline:!0},void 0,a),!this.shouldShowInline()&&h().createElement(h().Fragment,null,Object.entries(r).map((([e,i],s)=>t&&t[e]?void 0:this.renderKey(i,e,s))),n()(Z.Z,{style:{marginTop:8,marginBottom:8},isLarge:!0,onClick:this.handleSubmit,isRed:d},void 0,"Submit")),this.shouldShowInline()&&!p&&n()("div",{},void 0,n()(L.Z,{style:{width:18,height:18}}),"Loading ..."),this.renderError(p),this.renderResponse(p),"full"===u&&n()("div",{style:K.footerStyle},void 0,"Full Admin Tool"))}renderError(e){if(e&&"success"!==e.type)return n()("div",{style:K.responseErrorStyle},void 0,e.body.message)}renderResponse(e){if(!e||"success"!==e.type)return;const t=this.props.api.customResponseRenderer?n()(this.props.api.customResponseRenderer,{data:e.data,environment:this.environment,singleRecordMode:this.props.singleRecordMode}):n()(M.Z,{data:e.data});return this.shouldShowInline()?t:n()(I.Z,{open:Boolean(e&&"success"===e.type),innerStyle:K.modalStyle,onDismiss:this.handleModalDismiss,disableAnimation:!0,render:()=>t})}focus(){this.firstInputRef.current&&this.firstInputRef.current.focusInput()}downloadAsCsv(e){if(i=e,Boolean("success"===i.type&&Array.isArray(i.data)&&i.data.length>0)){const i=Array.from(e.data.reduce(((e,t)=>(Object.keys(t).forEach((t=>e.add(t))),e)),new Set)),s=[i];for(const t of e.data){const e=new Array(i.length);for(let s=0;s<e.length;s++){const n=i[s];e[s]=t[n]}s.push(e)}const n="data:text/csv;charset=utf-8,".concat(s.map((e=>e.join(","))).join("\n"));var t=encodeURI(n);return window.open(t),!0}var i;return!1}shouldShowInline(){const{showByDefault:e,singleRecordMode:t}=this.props;return e&&t}resetStoreState(e){const{defaultParams:t}=e,{store:i}=this.stores,s={};for(const n of Object.keys(e.api.schema)){const i=e.api.schema[n];t&&t[n]?s[n]=t[n]:i&&void 0!==i.defaultValue?s[n]=i.defaultValue:s[n]=void 0}i.setState({inputValues:s})}}l()(K,"undefinedKey","__undefined"),l()(K,"headerStyle",{fontWeight:C.Z.fontWeight.bold,fontSize:20,display:"flex",alignItems:"center",marginBottom:6}),l()(K,"footerStyle",{fontSize:10,position:"absolute",bottom:7,right:20}),l()(K,"responseErrorStyle",{color:A.ZP.red,display:"inline-flex",marginLeft:8}),l()(K,"modalStyle",{width:"calc(100% - 120px)",height:"calc(100% - 120px)",padding:24,fontSize:"1.2em",overflow:"scroll"});const N=K},27369:()=>{}}]);